{% load static %}

<html>
	<head>
		<title>Vote</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<script src="https://kit.fontawesome.com/17c066a4d1.js" crossorigin="anonymous"></script>

		<link href="{% static 'styles/fonts.css' %}" rel="stylesheet">
		<link href="{% static 'styles/polls.css' %}" rel="stylesheet">
	</head>
	<body>

		<div class="sidebar">
			<a href="logout" class="logout"><i class="fas fa-sign-out-alt"></i></a>
			<div class="mainInfo">
				<label>{{ user.username }}</label>
				{% if user.gender == 'Masculino' %}
					<img src="{% static 'imgs/defaultMaleIcon.png' %}">
				{% elif user.gender == 'Feminino' %}
					<img src="{% static 'imgs/defaultFemaleIcon.png' %}">
				{% endif %}
			</div>
			<div class="userOptions">
				<div class="userOption">
					Perfil
				</div>
				<div class="userOption">
					<a data-bs-target="#addPollModal" data-toggle="modal" id="openAddPoll">Criar enquete</a>
				</div>
				<div class="userOption">
					Amigos 
				</div>
				<div class="userOption">
					Configurações
				</div>
				<div class="userOption">
					Sobre
				</div>
			</div>
		</div>


		<div class="pollsContainer">
			{{ polls }}
		</div>
	</body>
	<div class="modal fade" id="addPollModal" role="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header bg-primary bg-gradient">
					<h5 class="modal-title" id="exampleModalLabel">Adicionar ao carrinho</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">

				</div>
				<div class="modal-footer bg-primary bg-gradient">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="">Confirmar</button>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		function sendVote(form, option) {
			o = option.id
			form.querySelector('#optionSelected').value = o

			formdata = new FormData(form);

			$.ajax({
				url: "vote",
				type: "POST",
				data: formdata,
			    processData: false,
			    contentType: false,
				success: function(result) {
			    	$.ajax({
						url: "polls",
						type: "GET",
						contentType: "json",
						success: function(result){
							updatePolls(result['calculatedChoices'])
					 	}
			 		});
			 	}
			 });
		}
	</script>
</html>